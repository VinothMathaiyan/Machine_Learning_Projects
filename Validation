import pandas as pd

def extract_valid_rows(df):
  """Extracts rows where either ID_valid or Email_valid is True and checks for email duplicates.

  Args:
    df: The pandas DataFrame.

  Returns:
    A pandas DataFrame with valid rows and a flag for duplicate emails.
  """

  # Filter rows where either ID_valid or Email_valid is True
  valid_df = df[(df['ID_valid'] == True) | (df['Email_valid'] == True)]

  # Check for duplicate emails
  valid_df['duplicate_email'] = valid_df['Email'].duplicated(keep='first')

  return valid_df

# Example usage:
# Assuming you have a DataFrame named df with columns 'ID', 'Email', 'ID_valid', and 'Email_valid'
valid_data = extract_valid_rows(df)
print(valid_data)
