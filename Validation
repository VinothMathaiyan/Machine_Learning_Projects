import pandas as pd

# Load the Excel file with multiple sheets
file_path = 'your_file.xlsx'  # Replace with your file path
excel_data = pd.read_excel(file_path, sheet_name=None)

# Load the df_key DataFrame
df_key = pd.read_excel('your_key_file.xlsx')  # Replace with your key file path

# Iterate through each sheet in the Excel file
for sheet_name, sheet_df in excel_data.items():
    # Merge each sheet with df_key based on the 'ID' column
    merged_df = pd.merge(sheet_df, df_key, on='ID', how='left')
    
    # Update the sheet data with the merged DataFrame
    excel_data[sheet_name] = merged_df

# Save the updated Excel file
output_file_path = 'updated_file.xlsx'  # Replace with your desired output file path
with pd.ExcelWriter(output_file_path) as writer:
    for sheet_name, sheet_df in excel_data.items():
        sheet_df.to_excel(writer, sheet_name=sheet_name, index=False)

print(f"Data has been successfully merged and saved to {output_file_path}")
